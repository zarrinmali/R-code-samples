---
title: "IMR-AFO Data Analysis"
author: "Zarrin Ali"
date: "2024-08-04"
output: html_document
---

```{r setup, include=FALSE}
pacman::p_load(
  here, foreign, tidyverse, raster, sf, httr2,
  tigris # Load Census TIGER/Line shapefiles
)
select <- dplyr::select
options(readr.show_col_types = F) # suppress read_csv info
options(dplyr.summarise.inform = F) # suppress summarize info
options(tigris_use_cache = T) # cache the data to avoid re-downloading in future R sessions

install.packages(c("lfe", "texreg", "stargazer")); library(lfe); library(texreg); library(stargazer)
```

This code was written by me when I was working as an RA for Professor Eyal Frank at Harris School of Public Policy in UChicago.

This script analyzes the relationship between infant mortality rates (IMR) and the number of animal feeding operations (AFOs) across counties in five U.S. states (NC, MI, WI, IA, MN). It uses datasets for IMR and AFOs by distance gradation around population-weighted and geographic centroids at the county-by-year-by-month level for each of the states mentioned. (These datasets are created in the script called IMR-AFO Data Wranging (for regressions)).The script constructs merged datasets at the county-year-month level, applies state-specific temporal truncations, and estimates fixed-effects regressions to quantify associations between AFO activity and IMR under varying model specifications. In total, 36 regression models are producedâ€”covering both IMR measures, centroid types, and fixed-effects combinations whose results are saved as text tables for further interpretation.


# Load datasets

```{r}
afos_by_county_yrmth_combined <- read_csv("/Users/zarrinali/Documents/AFOs data/All AFOs by county-yr-mth 1989-2018")

# IMR datasets
imr_dmf <- read_csv("/Users/zarrinali/Documents/AFOs data/Detailed mortality IMR.csv")
imr_lbd <- read_csv("/Users/zarrinali/Documents/AFOs data/Linked birth-death IMR.csv")

# AFO by dist grad around pop centroids

NC_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/NC AFO distance gradation by pop centroids")
MI_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/MI AFO distance gradation by pop centroids")
WI_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/WI AFO distance gradation by pop centroids")
IA_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/IA AFO distance gradation by pop centroids")
MN_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/MN AFO distance gradation by pop centroids")
combined_pop_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/ALL AFO distance gradation by pop centroids")


# AFO by dist grad around geo centroids

NC_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/NC AFO distance gradation by geo centroids")
MI_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/MI AFO distance gradation by geo centroids")
WI_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/WI AFO distance gradation by geo centroids")
IA_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/IA AFO distance gradation by geo centroids")
MN_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/MN AFO distance gradation by geo centroids")
combined_geo_dist_grad <- read_csv("/Users/zarrinali/Documents/AFOs data/ALL AFO distance gradation by geo centroids")
```

# County by year by month AFO and IMR

```{r}
# Merging IMR and AFO datasets

imr_dmf_afos_combined <- afos_by_county_yrmth_combined %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)
  

imr_lbd_afos_combined <- afos_by_county_yrmth_combined %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# This dataset with 5 states IMR and AFO data combined is not truncated
```

## State-by-state and combined (truncated) county-by-year-by-month AFO and IMR

```{r}
# Separating the merged IMR and AFO dataset by states and truncating the combined dataset

# NC
imr_dmf_afos_NC <- imr_dmf_afos_combined %>%
  filter(STATE == 37,year > 1997 | (year == 1997 & month >=3))

imr_lbd_afos_NC <- imr_lbd_afos_combined %>%
  filter(STATE == 37,year > 1997 | (year == 1997 & month >=3))

# MI
imr_dmf_afos_MI <- imr_dmf_afos_combined %>%
  filter(STATE == 26,year >= 2003)

imr_lbd_afos_MI <- imr_lbd_afos_combined %>%
  filter(STATE == 26,year >= 2003)

# WI
imr_dmf_afos_WI <- imr_dmf_afos_combined %>%
  filter(STATE == 55)

imr_lbd_afos_WI <- imr_lbd_afos_combined %>%
  filter(STATE == 55)

# IA
imr_dmf_afos_IA <- imr_dmf_afos_combined %>%
  filter(STATE == 19)

imr_lbd_afos_IA <- imr_lbd_afos_combined %>%
  filter(STATE == 19)

# MN
imr_dmf_afos_MN <- imr_dmf_afos_combined %>%
  filter(STATE == 27)

imr_lbd_afos_MN <- imr_lbd_afos_combined %>%
  filter(STATE == 27)

# 5 states combined and truncated dataset
imr_dmf_afos_combined_trunc <- imr_dmf_afos_combined %>%
  filter(STATE %in% c(37, 26, 55, 26, 19, 27), year >= 2003)

imr_lbd_afos_combined_trunc <- imr_lbd_afos_combined %>%
  filter(STATE %in% c(37, 26, 55, 26, 19, 27), year >= 2003) #Combined dataset is truncated to the common period between the 5 states, so 2003-2017/18 
```

```{r}
# Some notes about the IMR datasets

## Lbd IMR: If infant birth is 0 then IMR becomes NA. We are using births as regression weights so even if we set the IMR to be 0, they would get assigned a weight of 0 and get dropped. So dont worry about them getting dropped.

## afos_by_county_yrmth_combined has every county-yr-mth combination for all the states from 1989-2018. If imr_lbd has a county-yr-mth combination missing, then lbd_inf_births, deaths and IMR will show up as NA in the imr_lbd_afos_ dataset. I could manipulate it and put births and IMR to be 0 but it is redundant because in the regression, those observations would get assigned a weight of 0 and be dropped either way. So know need to get worried about this.

## Dmf IMR: Similarly for dmf IMR, imr_dmf has a county-yr-mth combination missing then pop, infant deaths and IMR would show up as NA in the combined imr and afo dataset. Can manipulate to make pop and IMR 0 but no point because in the regression those observations would get assigned a weight of 0 and be dropped either way.

# imr_dmf does not have NA in the infant deaths column and IMR column for any of our 6 core state counties, so no need to worry. (otherwise would have to manually make the IMR entries 0)
```

# AFO and IMR by distance gradation around pop-weighted centroids by county-yr-mth

```{r}
# Merging the IMR and AFO datasets by state and creating a combined dataset with all 5 states (this combined dataset is truncated to the common period between the states)

# NC

merged_pop_dmf_NC <- NC_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_NC <- NC_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# MI
merged_pop_dmf_MI <- MI_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_MI <- MI_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)


# WI
merged_pop_dmf_WI <- WI_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_WI <- WI_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# IA
merged_pop_dmf_IA <- IA_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_IA <- IA_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# MN
merged_pop_dmf_MN <- MN_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_MN <- MN_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)


# 5 states combined and truncated
merged_pop_dmf_combined <- combined_pop_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_pop_lbd_combined <- combined_pop_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)
```

# AFO and IMR by distance gradation around geo-weighted centroids by county-yr-mth

```{r}
# Merging the IMR and AFO datasets by state and creating a combined dataset with all 5 states (this combined dataset is truncated to the common period between the states)

# NC
merged_geo_dmf_NC <- NC_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_NC <- NC_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# MI
merged_geo_dmf_MI <- MI_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_MI <- MI_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# WI
merged_geo_dmf_WI <- WI_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_WI <- WI_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)


# IA
merged_geo_dmf_IA <- IA_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_IA <- IA_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# MN
merged_geo_dmf_MN <- MN_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_MN <- MN_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year >= 1995 & year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

# 5 states combined and truncated
merged_geo_dmf_combined <- combined_geo_dist_grad %>%
  left_join(imr_dmf, by = c("fips", "year", "month")) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

merged_geo_lbd_combined <- combined_geo_dist_grad %>%
  left_join(imr_lbd, by = c("fips", "year", "month")) %>%
  filter(year <= 2017) %>%
  rename(STATE = STATE.x) %>%
  select(-STATE.y)

```



# Regressions (36 tables in total)

```{r}
# There are 5 states, and 1 for all states combined, 2 different IMR (dmf and lbd) and 3 types of AFO counts (no distance bins, bins around population-weighted county centroids, and around geographic centroids)
# So 6x2x3 results in 36 regression tables.
# dmf stands for IMR calculated from Detailed Mortality Files and lbd for IMR from Linked Birth-Death certificates
```


## County-year-month (no distance bins)

### 5 states combined

```{r}
# Detailed mortality IMR

# Regression with county FEs and year FEs
combined_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)

# Regression with county FEs, year FEs, and month FEs
combined_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)

# Regression with county FEs and year-by-month FEs
imr_dmf_afos_combined_trunc$year_month <- interaction(imr_dmf_afos_combined_trunc$year, imr_dmf_afos_combined_trunc$month)
combined_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)

# Regression with county FEs and state-by-year FEs
imr_dmf_afos_combined_trunc$state_year <- interaction(imr_dmf_afos_combined_trunc$STATE, imr_dmf_afos_combined_trunc$year)
combined_dmf_4 <- felm(IMR ~ n_AFOs | fips + state_year, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)

# Regression with county FEs, state-by-year FEs, and state-by-month FEs
imr_dmf_afos_combined_trunc$state_month <- interaction(imr_dmf_afos_combined_trunc$STATE, imr_dmf_afos_combined_trunc$month)
combined_dmf_5 <- felm(IMR ~ n_AFOs | fips + state_year + state_month, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)

# Regression with county FEs and state-by-year-by-month FEs
imr_dmf_afos_combined_trunc$state_year_month <- interaction(imr_dmf_afos_combined_trunc$STATE, imr_dmf_afos_combined_trunc$year, imr_dmf_afos_combined_trunc$month)
combined_dmf_6 <- felm(IMR ~ n_AFOs | fips + state_year_month, data = imr_dmf_afos_combined_trunc, weights = imr_dmf_afos_combined_trunc$total_pop)


#Saving the table
writeLines(stargazer(combined_dmf_1, combined_dmf_2, combined_dmf_3, combined_dmf_4, combined_dmf_5, combined_dmf_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_dmf_results.txt")
```


```{r}
# Linked birth-death IMR

# Regression with county FEs and year FEs
combined_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)

# Regression with county FEs, year FEs, and month FEs
combined_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)

# Regression with county FEs and year-by-month FEs
imr_lbd_afos_combined_trunc$year_month <- interaction(imr_lbd_afos_combined_trunc$year, imr_lbd_afos_combined_trunc$month)
combined_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)

# Regression with county FEs and state-by-year FEs
imr_lbd_afos_combined_trunc$state_year <- interaction(imr_lbd_afos_combined_trunc$STATE, imr_lbd_afos_combined_trunc$year)
combined_lbd_4 <- felm(IMR ~ n_AFOs | fips + state_year, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)

# Regression with county FEs, state-by-year FEs, and state-by-month FEs
imr_lbd_afos_combined_trunc$state_month <- interaction(imr_lbd_afos_combined_trunc$STATE, imr_lbd_afos_combined_trunc$month)
combined_lbd_5 <- felm(IMR ~ n_AFOs | fips + state_year + state_month, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)

# Regression with county FEs and state-by-year-by-month FEs
imr_lbd_afos_combined_trunc$state_year_month <- interaction(imr_lbd_afos_combined_trunc$STATE, imr_lbd_afos_combined_trunc$year, imr_lbd_afos_combined_trunc$month)
combined_lbd_6 <- felm(IMR ~ n_AFOs | fips + state_year_month, data = imr_lbd_afos_combined_trunc, weights = imr_lbd_afos_combined_trunc$lbd_inf_births)



#Saving the table
writeLines(stargazer(combined_lbd_1, combined_lbd_2, combined_lbd_3, combined_lbd_4, combined_lbd_5, combined_lbd_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_lbd_results.txt")
```

### NC

```{r}
# dmf IMR

NC_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_NC, weights = imr_dmf_afos_NC$total_pop)

NC_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_NC, weights = imr_dmf_afos_NC$total_pop)

imr_dmf_afos_NC$year_month <- interaction(imr_dmf_afos_NC$year, imr_dmf_afos_NC$month)
NC_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_NC, weights = imr_dmf_afos_NC$total_pop)

#Saving the table
writeLines(stargazer(NC_dmf_1, NC_dmf_2, NC_dmf_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in NC with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_dmf_results.txt")

```


```{r}
# lbd IMR

NC_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_NC, weights = imr_lbd_afos_NC$lbd_inf_births)

NC_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_NC, weights = imr_lbd_afos_NC$lbd_inf_births)

imr_lbd_afos_NC$year_month <- interaction(imr_lbd_afos_NC$year, imr_lbd_afos_NC$month)
NC_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_NC, weights = imr_lbd_afos_NC$lbd_inf_births)

#Saving the table
writeLines(stargazer(NC_lbd_1, NC_lbd_2, NC_lbd_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in NC with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_lbd_results.txt")
```



### MI

```{r}
# dmf IMR

MI_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_MI, weights = imr_dmf_afos_MI$total_pop)

MI_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_MI, weights = imr_dmf_afos_MI$total_pop)

imr_dmf_afos_MI$year_month <- interaction(imr_dmf_afos_MI$year, imr_dmf_afos_MI$month)
MI_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_MI, weights = imr_dmf_afos_MI$total_pop)

# Saving the table
writeLines(stargazer(MI_dmf_1, MI_dmf_2, MI_dmf_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in MI with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_dmf_results.txt")
```

```{r}
# lbd IMR

MI_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_MI, weights = imr_lbd_afos_MI$lbd_inf_births)

MI_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_MI, weights = imr_lbd_afos_MI$lbd_inf_births)

imr_lbd_afos_MI$year_month <- interaction(imr_lbd_afos_MI$year, imr_lbd_afos_MI$month)
MI_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_MI, weights = imr_lbd_afos_MI$lbd_inf_births)

# Saving the table
writeLines(stargazer(MI_lbd_1, MI_lbd_2, MI_lbd_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in MI with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_lbd_results.txt")


```

### WI

```{r}
# dmf IMR

WI_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_WI, weights = imr_dmf_afos_WI$total_pop)

WI_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_WI, weights = imr_dmf_afos_WI$total_pop)

imr_dmf_afos_WI$year_month <- interaction(imr_dmf_afos_WI$year, imr_dmf_afos_WI$month)
WI_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_WI, weights = imr_dmf_afos_WI$total_pop)



# Saving the table
writeLines(stargazer(WI_dmf_1, WI_dmf_2, WI_dmf_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in WI with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_dmf_results.txt")

```

```{r}
# lbd IMR

WI_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_WI, weights = imr_lbd_afos_WI$lbd_inf_births)

WI_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_WI, weights = imr_lbd_afos_WI$lbd_inf_births)

imr_lbd_afos_WI$year_month <- interaction(imr_lbd_afos_WI$year, imr_lbd_afos_WI$month)
WI_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_WI, weights = imr_lbd_afos_WI$lbd_inf_births)


# Saving the table
writeLines(stargazer(WI_lbd_1, WI_lbd_2, WI_lbd_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in WI with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_lbd_results.txt")

```

### IA

```{r}
# dmf IMR

IA_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_IA, weights = imr_dmf_afos_IA$total_pop)

IA_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_IA, weights = imr_dmf_afos_IA$total_pop)

imr_dmf_afos_IA$year_month <- interaction(imr_dmf_afos_IA$year, imr_dmf_afos_IA$month)
IA_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_IA, weights = imr_dmf_afos_IA$total_pop)


# Saving the table
writeLines(stargazer(IA_dmf_1, IA_dmf_2, IA_dmf_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in IA with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_dmf_results.txt")

```

```{r}
# lbd IMR

IA_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_IA, weights = imr_lbd_afos_IA$lbd_inf_births)

IA_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_IA, weights = imr_lbd_afos_IA$lbd_inf_births)

imr_lbd_afos_IA$year_month <- interaction(imr_lbd_afos_IA$year, imr_lbd_afos_IA$month)
IA_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_IA, weights = imr_lbd_afos_IA$lbd_inf_births)


# Saving the table
writeLines(stargazer(IA_lbd_1, IA_lbd_2, IA_lbd_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in IA with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_lbd_results.txt")

```

### MN

```{r}
# dmf IMR

MN_dmf_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_dmf_afos_MN, weights = imr_dmf_afos_MN$total_pop)

MN_dmf_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_dmf_afos_MN, weights = imr_dmf_afos_MN$total_pop)

imr_dmf_afos_MN$year_month <- interaction(imr_dmf_afos_MN$year, imr_dmf_afos_MN$month)
MN_dmf_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_dmf_afos_MN, weights = imr_dmf_afos_MN$total_pop)

# Saving the table
writeLines(stargazer(MN_dmf_1, MN_dmf_2, MN_dmf_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in MN with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_dmf_results.txt")
```

```{r}
# lbd IMR

MN_lbd_1 <- felm(IMR ~ n_AFOs | fips + year, data = imr_lbd_afos_MN, weights = imr_lbd_afos_MN$lbd_inf_births)

MN_lbd_2 <- felm(IMR ~ n_AFOs | fips + year + month, data = imr_lbd_afos_MN, weights = imr_lbd_afos_MN$lbd_inf_births)

imr_lbd_afos_MN$year_month <- interaction(imr_lbd_afos_MN$year, imr_lbd_afos_MN$month)
MN_lbd_3 <- felm(IMR ~ n_AFOs | fips + year_month, data = imr_lbd_afos_MN, weights = imr_lbd_afos_MN$lbd_inf_births)

# Saving the table
writeLines(stargazer(MN_lbd_1, MN_lbd_2, MN_lbd_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in MN with Different Fixed Effects",
                        dep.var.labels = "IMR",
                        covariate.labels = "Number of AFOs"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_lbd_results.txt")
```

## County-year-month with AFO distance gradation around POPULATION centroids

### 5 states combined

```{r}
# dmf IMR

combined_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)

combined_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)

merged_pop_dmf_combined$year_month <- interaction(merged_pop_dmf_combined$year, merged_pop_dmf_combined$month)
combined_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)

merged_pop_dmf_combined$state_year <- interaction(merged_pop_dmf_combined$STATE, merged_pop_dmf_combined$year)
combined_dmf_pop_4 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)

merged_pop_dmf_combined$state_month <- interaction(merged_pop_dmf_combined$STATE, merged_pop_dmf_combined$month)
combined_dmf_pop_5 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year + state_month, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)

merged_pop_dmf_combined$state_year_month <- interaction(merged_pop_dmf_combined$STATE, merged_pop_dmf_combined$year, merged_pop_dmf_combined$month)
combined_dmf_pop_6 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year_month, data = merged_pop_dmf_combined, weights = merged_pop_dmf_combined$total_pop)


#Saving the table
writeLines(stargazer(combined_dmf_pop_1, combined_dmf_pop_2, combined_dmf_pop_3, combined_dmf_pop_4, combined_dmf_pop_5, combined_dmf_pop_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around Population Centroids with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_dmf_pop_results.txt")
```

```{r}
# lbd IMR

combined_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

combined_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

merged_pop_lbd_combined$year_month <- interaction(merged_pop_lbd_combined$year, merged_pop_lbd_combined$month)
combined_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

merged_pop_lbd_combined$state_year <- interaction(merged_pop_lbd_combined$STATE, merged_pop_lbd_combined$year)
combined_lbd_pop_4 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

merged_pop_lbd_combined$state_month <- interaction(merged_pop_lbd_combined$STATE, merged_pop_lbd_combined$month)
combined_lbd_pop_5 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year + state_month, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

merged_pop_lbd_combined$state_year_month <- interaction(merged_pop_lbd_combined$STATE, merged_pop_lbd_combined$year, merged_pop_lbd_combined$month)
combined_lbd_pop_6 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year_month, data = merged_pop_lbd_combined, weights = merged_pop_lbd_combined$lbd_inf_births)

#Saving the table
writeLines(stargazer(combined_lbd_pop_1, combined_lbd_pop_2, combined_lbd_pop_3, combined_lbd_pop_4, combined_lbd_pop_5, combined_lbd_pop_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around Population Centroids with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_lbd_pop_results.txt")
```

### NC

```{r}
# dmf IMR

NC_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_NC, weights = merged_pop_dmf_NC$total_pop)

NC_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_NC, weights = merged_pop_dmf_NC$total_pop)

merged_pop_dmf_NC$year_month <- interaction(merged_pop_dmf_NC$year, merged_pop_dmf_NC$month)
NC_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_NC, weights = merged_pop_dmf_NC$total_pop)

#Saving the table
writeLines(stargazer(NC_dmf_pop_1, NC_dmf_pop_2, NC_dmf_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Population Centroids in NC with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_dmf_pop_results.txt")
```

```{r}
# lbd IMR

NC_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_NC, weights = merged_pop_lbd_NC$lbd_inf_births)

NC_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_NC, weights = merged_pop_lbd_NC$lbd_inf_births)

merged_pop_lbd_NC$year_month <- interaction(merged_pop_lbd_NC$year, merged_pop_lbd_NC$month)
NC_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_NC, weights = merged_pop_lbd_NC$lbd_inf_births)


#Saving the table
writeLines(stargazer(NC_lbd_pop_1, NC_lbd_pop_2, NC_lbd_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Population Centroids in NC with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_lbd_pop_results.txt")

```

### MI

```{r}
# dmf IMR

MI_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_MI, weights = merged_pop_dmf_MI$total_pop)

MI_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_MI, weights = merged_pop_dmf_MI$total_pop)

merged_pop_dmf_MI$year_month <- interaction(merged_pop_dmf_MI$year, merged_pop_dmf_MI$month)
MI_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_MI, weights = merged_pop_dmf_MI$total_pop)


# Saving the table
writeLines(stargazer(MI_dmf_pop_1, MI_dmf_pop_2, MI_dmf_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Population Centroids in MI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_dmf_pop_results.txt")
```

```{r}
# lbd IMR

MI_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_MI, weights = merged_pop_lbd_MI$lbd_inf_births)

MI_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_MI, weights = merged_pop_lbd_MI$lbd_inf_births)

merged_pop_lbd_MI$year_month <- interaction(merged_pop_lbd_MI$year, merged_pop_lbd_MI$month)
MI_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_MI, weights = merged_pop_lbd_MI$lbd_inf_births)


# Saving the table
writeLines(stargazer(MI_lbd_pop_1, MI_lbd_pop_2, MI_lbd_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Population Centroids in MI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_lbd_pop_results.txt")
```

### WI

```{r}
# dmf IMR

WI_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_WI, weights = merged_pop_dmf_WI$total_pop)

WI_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_WI, weights = merged_pop_dmf_WI$total_pop)

merged_pop_dmf_WI$year_month <- interaction(merged_pop_dmf_WI$year, merged_pop_dmf_WI$month)
WI_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_WI, weights = merged_pop_dmf_WI$total_pop)


# Saving the table
writeLines(stargazer(WI_dmf_pop_1, WI_dmf_pop_2, WI_dmf_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Population Centroids in WI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_dmf_pop_results.txt")
```

```{r}
# lbd IMR

WI_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_WI, weights = merged_pop_lbd_WI$lbd_inf_births)

WI_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_WI, weights = merged_pop_lbd_WI$lbd_inf_births)

merged_pop_lbd_WI$year_month <- interaction(merged_pop_lbd_WI$year, merged_pop_lbd_WI$month)
WI_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_WI, weights = merged_pop_lbd_WI$lbd_inf_births)

# Saving the table
writeLines(stargazer(WI_lbd_pop_1, WI_lbd_pop_2, WI_lbd_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Population Centroids in WI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_lbd_pop_results.txt")

```

### IA

```{r}
# dmf IMR

IA_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_IA, weights = merged_pop_dmf_IA$total_pop)

IA_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_IA, weights = merged_pop_dmf_IA$total_pop)

merged_pop_dmf_IA$year_month <- interaction(merged_pop_dmf_IA$year, merged_pop_dmf_IA$month)
IA_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_IA, weights = merged_pop_dmf_IA$total_pop)

# Saving the table
writeLines(stargazer(IA_dmf_pop_1, IA_dmf_pop_2, IA_dmf_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Population Centroids in IA with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_dmf_pop_results.txt")

```

```{r}
# lbd IMR

IA_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_IA, weights = merged_pop_lbd_IA$lbd_inf_births)

IA_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_IA, weights = merged_pop_lbd_IA$lbd_inf_births)

merged_pop_lbd_IA$year_month <- interaction(merged_pop_lbd_IA$year, merged_pop_lbd_IA$month)
IA_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_IA, weights = merged_pop_lbd_IA$lbd_inf_births)

# Saving the table
writeLines(stargazer(IA_lbd_pop_1, IA_lbd_pop_2, IA_lbd_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Population Centroids in IA with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_lbd_pop_results.txt")

```

### MN

```{r}
# dmf IMR

MN_dmf_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_dmf_MN, weights = merged_pop_dmf_MN$total_pop)

MN_dmf_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_dmf_MN, weights = merged_pop_dmf_MN$total_pop)

merged_pop_dmf_MN$year_month <- interaction(merged_pop_dmf_MN$year, merged_pop_dmf_MN$month)
MN_dmf_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_dmf_MN, weights = merged_pop_dmf_MN$total_pop)


# Saving the table
writeLines(stargazer(MN_dmf_pop_1, MN_dmf_pop_2, MN_dmf_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Population Centroids in MN with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_dmf_pop_results.txt")
```

```{r}
# lbd IMR

MN_lbd_pop_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_pop_lbd_MN, weights = merged_pop_lbd_MN$lbd_inf_births)

MN_lbd_pop_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_pop_lbd_MN, weights = merged_pop_lbd_MN$lbd_inf_births)

merged_pop_lbd_MN$year_month <- interaction(merged_pop_lbd_MN$year, merged_pop_lbd_MN$month)
MN_lbd_pop_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_pop_lbd_MN, weights = merged_pop_lbd_MN$lbd_inf_births)


# Saving the table
writeLines(stargazer(MN_lbd_pop_1, MN_lbd_pop_2, MN_lbd_pop_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Population Centroids in MN with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_lbd_pop_results.txt")


```

## County-year-month with AFO distance gradation around GEOGRAPHIC centroids

### 5 states combined

```{r}
# dmf IMR

combined_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

combined_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

merged_geo_dmf_combined$year_month <- interaction(merged_geo_dmf_combined$year, merged_geo_dmf_combined$month)
combined_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

merged_geo_dmf_combined$state_year <- interaction(merged_geo_dmf_combined$STATE, merged_geo_dmf_combined$year)
combined_dmf_geo_4 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

merged_geo_dmf_combined$state_month <- interaction(merged_geo_dmf_combined$STATE, merged_geo_dmf_combined$month)
combined_dmf_geo_5 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year + state_month, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

merged_geo_dmf_combined$state_year_month <- interaction(merged_geo_dmf_combined$STATE, merged_geo_dmf_combined$year, merged_geo_dmf_combined$month)
combined_dmf_geo_6 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year_month, data = merged_geo_dmf_combined, weights = merged_geo_dmf_combined$total_pop)

#Saving the table
writeLines(stargazer(combined_dmf_geo_1, combined_dmf_geo_2, combined_dmf_geo_3, combined_dmf_geo_4, combined_dmf_geo_5, combined_dmf_geo_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around Geographic Centroids with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_dmf_geo_results.txt")
```

```{r}
# lbd IMR

combined_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

combined_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

merged_geo_lbd_combined$year_month <- interaction(merged_geo_lbd_combined$year, merged_geo_lbd_combined$month)
combined_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

merged_geo_lbd_combined$state_year <- interaction(merged_geo_lbd_combined$STATE, merged_geo_lbd_combined$year)
combined_lbd_geo_4 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

merged_geo_lbd_combined$state_month <- interaction(merged_geo_lbd_combined$STATE, merged_geo_lbd_combined$month)
combined_lbd_geo_5 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year + state_month, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

merged_geo_lbd_combined$state_year_month <- interaction(merged_geo_lbd_combined$STATE, merged_geo_lbd_combined$year, merged_geo_lbd_combined$month)
combined_lbd_geo_6 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + state_year_month, data = merged_geo_lbd_combined, weights = merged_geo_lbd_combined$lbd_inf_births)

#Saving the table
writeLines(stargazer(combined_lbd_geo_1, combined_lbd_geo_2, combined_lbd_geo_3, combined_lbd_geo_4, combined_lbd_geo_5, combined_lbd_geo_6, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month", "County + State-Year", "County + State-Year + State-Month", "County + State-Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around Geographic Centroids with Different Fixed Effects (5 states combined)",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/combined_lbd_geo_results.txt")
```

### NC

```{r}
# dmf IMR

NC_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_NC, weights = merged_geo_dmf_NC$total_pop)

NC_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_NC, weights = merged_geo_dmf_NC$total_pop)

merged_geo_dmf_NC$year_month <- interaction(merged_geo_dmf_NC$year, merged_geo_dmf_NC$month)
NC_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_NC, weights = merged_geo_dmf_NC$total_pop)

#Saving the table
writeLines(stargazer(NC_dmf_geo_1, NC_dmf_geo_2, NC_dmf_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Geographic Centroids in NC with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_dmf_geo_results.txt")
```

```{r}
# lbd IMR

NC_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_NC, weights = merged_geo_lbd_NC$lbd_inf_births)

NC_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_NC, weights = merged_geo_lbd_NC$lbd_inf_births)

merged_geo_lbd_NC$year_month <- interaction(merged_geo_lbd_NC$year, merged_geo_lbd_NC$month)
NC_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_NC, weights = merged_geo_lbd_NC$lbd_inf_births)


#Saving the table
writeLines(stargazer(NC_lbd_geo_1, NC_lbd_geo_2, NC_lbd_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Geographic Centroids in NC with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/NC_lbd_geo_results.txt")
```

### MI

```{r}
# dmf IMR

MI_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_MI, weights = merged_geo_dmf_MI$total_pop)

MI_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_MI, weights = merged_geo_dmf_MI$total_pop)

merged_geo_dmf_MI$year_month <- interaction(merged_geo_dmf_MI$year, merged_geo_dmf_MI$month)
MI_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_MI, weights = merged_geo_dmf_MI$total_pop)

# Saving the table
writeLines(stargazer(MI_dmf_geo_1, MI_dmf_geo_2, MI_dmf_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Geographic Centroids in MI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_dmf_geo_results.txt")
```

```{r}
# lbd IMR

MI_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_MI, weights = merged_geo_lbd_MI$lbd_inf_births)

MI_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_MI, weights = merged_geo_lbd_MI$lbd_inf_births)

merged_geo_lbd_MI$year_month <- interaction(merged_geo_lbd_MI$year, merged_geo_lbd_MI$month)
MI_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_MI, weights = merged_geo_lbd_MI$lbd_inf_births)

# Saving the table
writeLines(stargazer(MI_lbd_geo_1, MI_lbd_geo_2, MI_lbd_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Geographic Centroids in MI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MI_lbd_geo_results.txt")
```

### WI

```{r}
# dmf IMR

WI_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_WI, weights = merged_geo_dmf_WI$total_pop)

WI_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_WI, weights = merged_geo_dmf_WI$total_pop)

merged_geo_dmf_WI$year_month <- interaction(merged_geo_dmf_WI$year, merged_geo_dmf_WI$month)
WI_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_WI, weights = merged_geo_dmf_WI$total_pop)

# Saving the table
writeLines(stargazer(WI_dmf_geo_1, WI_dmf_geo_2, WI_dmf_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Geographic Centroids in WI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_dmf_geo_results.txt")
```

```{r}
# lbd IMR

WI_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_WI, weights = merged_geo_lbd_WI$lbd_inf_births)

WI_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_WI, weights = merged_geo_lbd_WI$lbd_inf_births)

merged_geo_lbd_WI$year_month <- interaction(merged_geo_lbd_WI$year, merged_geo_lbd_WI$month)
WI_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_WI, weights = merged_geo_lbd_WI$lbd_inf_births)

# Saving the table
writeLines(stargazer(WI_lbd_geo_1, WI_lbd_geo_2, WI_lbd_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Geographic Centroids in WI with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/WI_lbd_geo_results.txt")
```

### IA

```{r}
# dmf IMR

IA_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_IA, weights = merged_geo_dmf_IA$total_pop)

IA_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_IA, weights = merged_geo_dmf_IA$total_pop)

merged_geo_dmf_IA$year_month <- interaction(merged_geo_dmf_IA$year, merged_geo_dmf_IA$month)
IA_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_IA, weights = merged_geo_dmf_IA$total_pop)

# Saving the table
writeLines(stargazer(IA_dmf_geo_1, IA_dmf_geo_2, IA_dmf_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Geographic Centroids in IA with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_dmf_geo_results.txt")
```

```{r}
# lbd IMR

IA_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_IA, weights = merged_geo_lbd_IA$lbd_inf_births)

IA_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_IA, weights = merged_geo_lbd_IA$lbd_inf_births)

merged_geo_lbd_IA$year_month <- interaction(merged_geo_lbd_IA$year, merged_geo_lbd_IA$month)
IA_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_IA, weights = merged_geo_lbd_IA$lbd_inf_births)

# Saving the table
writeLines(stargazer(IA_lbd_geo_1, IA_lbd_geo_2, IA_lbd_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Geographic Centroids in IA with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/IA_lbd_geo_results.txt")
```

### MN

```{r}
# dmf IMR

MN_dmf_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_dmf_MN, weights = merged_geo_dmf_MN$total_pop)

MN_dmf_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_dmf_MN, weights = merged_geo_dmf_MN$total_pop)

merged_geo_dmf_MN$year_month <- interaction(merged_geo_dmf_MN$year, merged_geo_dmf_MN$month)
MN_dmf_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_dmf_MN, weights = merged_geo_dmf_MN$total_pop)

# Saving the table
writeLines(stargazer(MN_dmf_geo_1, MN_dmf_geo_2, MN_dmf_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month DMF IMR on No. of AFOs in Bins around the Geographic Centroids in MN with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_dmf_geo_results.txt")
```

```{r}
# lbd IMR

MN_lbd_geo_1 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year, data = merged_geo_lbd_MN, weights = merged_geo_lbd_MN$lbd_inf_births)

MN_lbd_geo_2 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year + month, data = merged_geo_lbd_MN, weights = merged_geo_lbd_MN$lbd_inf_births)

merged_geo_lbd_MN$year_month <- interaction(merged_geo_lbd_MN$year, merged_geo_lbd_MN$month)
MN_lbd_geo_3 <- felm(IMR ~ count_under_5 + count_5_to_10 + count_10_to_15 + count_15_to_20 + count_20_to_25 + count_25_to_30 + count_30_to_40 + count_40_to_100 | fips + year_month, data = merged_geo_lbd_MN, weights = merged_geo_lbd_MN$lbd_inf_births)

# Saving the table
writeLines(stargazer(MN_lbd_geo_1, MN_lbd_geo_2, MN_lbd_geo_3, type = "text",
                        column.labels = c("County + Year", "County + Year + Month", "County + Year-Month"),
                        title = "Regression Results: County-by-year-by-month LBD IMR on No. of AFOs in Bins around the Geographic Centroids in MN with Different Fixed Effects",
                        dep.var.labels = "IMR"),
           "/Users/zarrinali/Documents/AFOs data/Reg tables/MN_lbd_geo_results.txt")

```
